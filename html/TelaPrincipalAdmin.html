<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../css/TelaPrincipal.css" />
    <link rel="stylesheet" href="../css/gerencFuncionarios.css" />
    <link rel="stylesheet" href="../css/gerencChamados.css" />
    <link rel="stylesheet" href="../css/subtelaCadTec.css" />
    <link rel="stylesheet" href="../css/meusDados.css">
    <title>Tela Principal - Admin</title>
  </head>
  <body>
    <div class="container-tela">
      <!-- Coluna lateral esquerda -->
      <div class="conteudo-lateral">
        <div class="perfil">
          <div class="perfil-top">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="size-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"
              />
            </svg>
            <p id="nome-usuario"></p>
          </div>
          <div class="acessos">
            <p id="data-acesso"></p>
            <p id="ip-acesso"></p>
          </div>
        </div>

        <hr
          style="
            width: 100%;
            border: 0;
            border-top: 1px solid #6a6e72;
            margin: 5px 0 15px 0;
          "
        />

        <div class="menu">
          <button
            id="btn-gerencFuncionarios"
            onclick="mostrarTela('gerencFuncionarios')"
          >
            Gerenciar<br />Funcionários
          </button>
          <hr
            style="
              width: 100%;
              border: 0;
              border-top: 1px solid #6a6e72;
              margin: 5px 0;
            "
          />
          <button
            id="btn-gerencChamados"
            onclick="mostrarTela('gerencChamados')"
          >
            Gerenciar<br />Chamados
          </button>
          <hr
            style="
              width: 100%;
              border: 0;
              border-top: 1px solid #6a6e72;
              margin: 5px 0;
            "
          />
          <button
            id="btn-meusDadosAdmin"
            onclick="mostrarTela('meusDadosAdmin')"
          >
            Meus Dados
          </button>
        </div>

        <div class="copy-logOut">
          <div class="log-out" id="btnLogout">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
              stroke-width="1.5" stroke="currentColor" class="size-6">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9" />
            </svg>
          </div>
          <span class="copyright"> © 2025 Forward Solutions. Todos os direitos reservados.</span>
        </div>
      </div>

      <div class="tela-central" id="area">
        <!--retorna todas as quatro telas de acorddo com o botão que a pessoa clica-->
      </div>
    </div>

    <!-- Pop-up de confirmação de logout -->
    <div id="popup-logout" class="popup-overlay">
      <div class="popup-content">
        <h3>Tem certeza que deseja deslogar do sistema?</h3>
        <div class="botoes-popup">
          <button id="cancelarLogout">CANCELAR</button>
          <button id="confirmarLogout">TENHO CERTEZA</button>
        </div>
      </div>
    </div>

    <script src="../js/dateTime_ip.js"></script>
    <script>
      // troca as tela da área principal
      function mostrarTela(tela) {
        const area = document.getElementById("area");
        let conteudo = "";

        if (tela === "gerencFuncionarios") {
          conteudo = `
                <div class="container-Funcionarios">
                    <h2>FUNCIONÁRIOS</h2>

                    <hr style="width: 100%; border: 0; border-top: 1px solid #6A6E72; margin: 10px 0 20px 0;">

                    <div class="barra-pesquisa">
                    <input type="text" id="pesquisa" placeholder="Digite o nome ou e-mail do funcionário...">
                    </div>

                    <table>
                    <thead>
                        <tr>
                        <th>Categoria</th>
                        <th>Nome</th>
                        <th>E-mail</th>
                        <th>Ação</th>
                        </tr>
                    </thead>

                    <tbody id="tabela-funcionarios"></tbody>
                    </table>

                    <div class="menu-flutuante">
                    <div class="opcoes">
                        <button class="opcao" id="btnCadTec">Cadastrar Técnico</button>
                        <button class="opcao" id="btnCadAdmin">Cadastrar Admin</button>
                    </div>

                    <button id="toggle-btn" class="toggle-btn">
                        <svg id="icone-mais" xmlns="http://www.w3.org/2000/svg" fill="none" 
                            viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" 
                                d="M12 4.5v15m7.5-7.5h-15" />
                        </svg>

                        <svg id="icone-x" xmlns="http://www.w3.org/2000/svg" fill="none" 
                            viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" 
                                d="M6 18 18 6M6 6l12 12" />
                        </svg>
                    </button>
                    </div>
                </div>
            `;
            setTimeout(() => carregarFuncionarios(), 50);

        }
        // Subtela - Cadastrar Tecnico
        else if (tela === "subtelaCadTec") {
          conteudo = `
                <div class="container-cadTec" id="cadastro-tec">
                    <div class="info-top">
                        <svg 
                        id="voltar"
                        xmlns="http://www.w3.org/2000/svg" 
                        fill="none" 
                        viewBox="0 0 24 24" 
                        stroke-width="1.5" 
                        stroke="currentColor" 
                        class="size-6">
                            <path 
                            stroke-linecap="round" 
                            stroke-linejoin="round" 
                            d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
                        </svg>
                        <h2>CADASTRAR TÉCNICO</h2>
                    </div>

                    <hr style="width: 100%; border: 0; border-top: 1px solid #6A6E72; margin: 10px 0 25px 0;">

                    <form id="cadastroTecForm">
                        <!--Campo: Nome-->
                        <div class="form-group row">
                            <div class="form-field">
                                <label for="nome" class="input-nome">Nome completo<span>*</span></label>
                                <input class="input-nome" type="text" id="nome">
                                <small class="erro" id="erroNome"></small>
                            </div>
                            <div class="form-field">
                                <label for="id">ID<span>*</span></label>
                                <input type="text" name="" id="id" readonly>
                                <small class="erro" id="erroId"></small>
                            </div>
                        </div>

                        <!--Campo: CPF e Telefone-->
                        <div class="form-group row">
                            <div class="form-field">
                                <label for="cpf">CPF<span>*</span></label>
                                <input type="text" name="" id="cpf">
                                <small class="erro" id="erroCpf"></small>
                            </div>
                            <div class="form-field">
                                <label for="telefone">Telefone<span>*</span></label>
                                <input type="tel" id="telefone">
                                <small class="erro" id="erroTelefone"></small>
                            </div>
                        </div>

                        <!--Campos: Área de especialização e nível de experiência-->
                        <div class="form-group row">
                            <div class="form-field">
                                <label for="areaEspecializacao">Área de Especilização<span>*</span></label>
                                <select id="areaEspecializacao">
                                    <option value="">Selecione...</option>
                                    <option value="sistemas">Sistemas e Maquininhas</option>
                                    <option value="equipamentos">Equipamentos</option>
                                    <option value="redes">Redes e Internet</option>
                                    <option value="impressoras">Impressoras e Periféricos</option>
                                    <option value="instalacao">Instalação / Atualização</option>
                                </select>
                                <small class="erro" id="erroArea"></small>
                            </div>
                            <div class="form-field">
                                <label for="nivelExperiencia">Nível de Experiência<span>*</span></label>
                                <select id="nivelExperiencia">
                                    <option value="">Selecione...</option>
                                    <option value="junior">Júnior</option>
                                    <option value="pleno">Pleno</option>
                                    <option value="senior">Sênior</option>
                                    <option value="especialista">Especialista</option>
                                </select>
                                <small class="erro" id="erroNivel"></small>
                            </div>
                        </div>

                        <hr style="width: 100%; border: 0; border-top: 1px solid #6A6E72; margin: 10px 0 15px 0;">

                        <div class="button">
                            <button type="submit" class="btn-avancar" id="btnAvancar">AVANÇAR</button>
                        </div>
                    </form>
                </div>
                `;
        }
        // Subtela - Parte 2 do cadastro do técnico
        else if (tela === "subtelaCadTec2") {
          conteudo = `
                <div class="container-cadTec2" id="cadastro-tec2">
                    <div class="info-top">
                        <svg 
                        id="voltar"
                        xmlns="http://www.w3.org/2000/svg" 
                        fill="none" 
                        viewBox="0 0 24 24" 
                        stroke-width="1.5" 
                        stroke="currentColor" 
                        class="size-6">
                            <path 
                            stroke-linecap="round" 
                            stroke-linejoin="round" 
                            d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
                        </svg>
                        <h2>CADASTRAR TÉCNICO</h2>
                    </div>
                    
                    <hr style="width: 100%; border: 0; border-top: 1px solid #6A6E72; margin: 0 0 20px 0;">

                    <form id="cadastroTecForm">
                        <!--Campo: E-mail-->
                        <div class="form-group">
                            <label for="email">E-mail Corporativo:<span>*</span></label>
                            <input type="text" id="email">
                            <small class="erro" id="erroEmail"></small>
                        </div>

                        <!--Campo: Senha-->
                        <div class="form-group">
                            <label for="password">Senha:<span>*</span></label>
                            <div class="senha-conteiner">
                                <input type="password" name="" id="senha">
                                <button type="button" class="toggle-password" id="togglePassword1" aria-label="Mostrar senha" aria-pressed="false" title="Mostrar senha">
                                    <!-- olho fechado -->
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" id="eye-closed1" class="icone-senha">
                                        <path d="M3.53 2.47a.75.75 0 0 0-1.06 1.06l18 18a.75.75 0 1 0 1.06-1.06l-18-18ZM22.676 12.553a11.249 11.249 0 0 1-2.631 4.31l-3.099-3.099a5.25 5.25 0 0 0-6.71-6.71L7.759 4.577a11.217 11.217 0 0 1 4.242-.827c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113Z" />
                                        <path d="M15.75 12c0 .18-.013.357-.037.53l-4.244-4.243A3.75 3.75 0 0 1 15.75 12ZM12.53 15.713l-4.243-4.244a3.75 3.75 0 0 0 4.244 4.243Z" />
                                        <path d="M6.75 12c0-.619.107-1.213.304-1.764l-3.1-3.1a11.25 11.25 0 0 0-2.63 4.31c-.12.362-.12.752 0 1.114 1.489 4.467 5.704 7.69 10.675 7.69 1.5 0 2.933-.294 4.242-.827l-2.477-2.477A5.25 5.25 0 0 1 6.75 12Z" />
                                    </svg>

                                    <!-- olho aberto -->
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" id="eye-open1" class="icone-senha" style="display: none;">
                                        <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
                                        <path fill-rule="evenodd" d="M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 0 1 0-1.113ZM17.25 12a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Z" clip-rule="evenodd" />
                                    </svg>
                                </button>
                            </div>
                            <small class="erro" id="erroSenha"></small>
                        </div>

                        <!--Campos: Repetir senha-->
                        <div class="form-group">
                            <label for="repetirSenha">Repita a senha:<span>*</span></label>
                            <div class="repetirSenha-container">
                                <input type="password" id="repetirSenha">
                                <button type="button" class="toggle-password" id="togglePassword2" aria-label="Mostrar senha" aria-pressed="false" title="Mostrar senha">
                                    <!-- olho fechado -->
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" id="eye-closed2" class="icone-senha">
                                        <path d="M3.53 2.47a.75.75 0 0 0-1.06 1.06l18 18a.75.75 0 1 0 1.06-1.06l-18-18ZM22.676 12.553a11.249 11.249 0 0 1-2.631 4.31l-3.099-3.099a5.25 5.25 0 0 0-6.71-6.71L7.759 4.577a11.217 11.217 0 0 1 4.242-.827c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113Z" />
                                        <path d="M15.75 12c0 .18-.013.357-.037.53l-4.244-4.243A3.75 3.75 0 0 1 15.75 12ZM12.53 15.713l-4.243-4.244a3.75 3.75 0 0 0 4.244 4.243Z" />
                                        <path d="M6.75 12c0-.619.107-1.213.304-1.764l-3.1-3.1a11.25 11.25 0 0 0-2.63 4.31c-.12.362-.12.752 0 1.114 1.489 4.467 5.704 7.69 10.675 7.69 1.5 0 2.933-.294 4.242-.827l-2.477-2.477A5.25 5.25 0 0 1 6.75 12Z" />
                                    </svg>

                                    <!-- olho aberto -->
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" id="eye-open2" class="icone-senha" style="display: none;">
                                        <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
                                        <path fill-rule="evenodd" d="M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 0 1 0-1.113ZM17.25 12a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Z" clip-rule="evenodd" />
                                    </svg>
                                </button>
                            </div>
                            <small class="erro" id="erroRepetirSenha"></small>
                        </div>

                        <hr style="width: 100%; border: 0; border-top: 1px solid #6A6E72; margin: 5px 0 10px 0;">

                        <div class="button">
                            <button type="submit" class="btn-cadastrar">CADASTRAR</button>
                        </div>
                    </form>
                </div>
                `;
        }
        // Subtela - Cadastrar Admin
        else if (tela === "subtelaCadAdmin") {
          conteudo = `
            <div class="container-cadTec" id="cadastro-tec">
                <div class="info-top">
                    <svg 
                    id="voltar"
                    xmlns="http://www.w3.org/2000/svg" 
                    fill="none" 
                    viewBox="0 0 24 24" 
                    stroke-width="1.5" 
                    stroke="currentColor" 
                    class="size-6">
                        <path 
                        stroke-linecap="round" 
                        stroke-linejoin="round" 
                        d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
                    </svg>
                    <h2>CADASTRAR ADMINISTRADOR</h2>
                </div>

                <hr style="width: 100%; border: 0; border-top: 1px solid #6A6E72; margin: 10px 0 25px 0;">

                <form id="cadastroTecForm">
                    <!--Campo: Nome-->
                    <div class="form-group row">
                        <div class="form-field">
                            <label for="nome" class="input-nome">Nome completo<span>*</span></label>
                            <input class="input-nome" type="text" id="nome">
                            <small class="erro" id="erroNome"></small>
                        </div>
                        <div class="form-field">
                            <label for="id">ID<span>*</span></label>
                            <input type="text" name="" id="id" readonly>
                            <small class="erro" id="erroId"></small>
                        </div>
                    </div>

                    <!--Campo: CPF e Telefone-->
                    <div class="form-group row">
                        <div class="form-field">
                            <label for="cpf">CPF<span>*</span></label>
                            <input type="text" name="" id="cpf">
                            <small class="erro" id="erroCpf"></small>
                        </div>
                        <div class="form-field">
                            <label for="telefone">Telefone<span>*</span></label>
                            <input type="tel" id="telefone">
                            <small class="erro" id="erroTelefone"></small>
                        </div>
                    </div>

                    <hr style="width: 100%; border: 0; border-top: 1px solid #6A6E72; margin: 10px 0 15px 0;">

                    <div class="button">
                        <button type="submit" class="btn-avancar" id="btnAvancar">AVANÇAR</button>
                    </div>
                </form>
            </div>
          `;
        } 
        // Subtela - Cadastrar Admin
        else if (tela === "subtelaCadAdmin2") {
          conteudo = `
          <div class="container-cadTec2" id="cadastro-tec2">
                    <div class="info-top">
                        <svg 
                        id="voltar"
                        xmlns="http://www.w3.org/2000/svg" 
                        fill="none" 
                        viewBox="0 0 24 24" 
                        stroke-width="1.5" 
                        stroke="currentColor" 
                        class="size-6">
                            <path 
                            stroke-linecap="round" 
                            stroke-linejoin="round" 
                            d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
                        </svg>
                        <h2>CADASTRAR ADMINISTRADOR</h2>
                    </div>
                    
                    <hr style="width: 100%; border: 0; border-top: 1px solid #6A6E72; margin: 0 0 20px 0;">

                    <form id="cadastroTecForm">
                        <!--Campo: E-mail Corporativo-->
                        <div class="form-group">
                            <label for="email">E-mail Corporativo:<span>*</span></label>
                            <input type="text" id="email">
                            <small class="erro" id="erroEmail"></small>
                        </div>

                        <!--Campo: Senha-->
                        <div class="form-group">
                            <label for="password">Senha:<span>*</span></label>
                            <div class="senha-conteiner">
                                <input type="password" name="" id="senha">
                                <button type="button" class="toggle-password" id="togglePassword1" aria-label="Mostrar senha" aria-pressed="false" title="Mostrar senha">
                                    <!-- olho fechado -->
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" id="eye-closed1" class="icone-senha">
                                        <path d="M3.53 2.47a.75.75 0 0 0-1.06 1.06l18 18a.75.75 0 1 0 1.06-1.06l-18-18ZM22.676 12.553a11.249 11.249 0 0 1-2.631 4.31l-3.099-3.099a5.25 5.25 0 0 0-6.71-6.71L7.759 4.577a11.217 11.217 0 0 1 4.242-.827c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113Z" />
                                        <path d="M15.75 12c0 .18-.013.357-.037.53l-4.244-4.243A3.75 3.75 0 0 1 15.75 12ZM12.53 15.713l-4.243-4.244a3.75 3.75 0 0 0 4.244 4.243Z" />
                                        <path d="M6.75 12c0-.619.107-1.213.304-1.764l-3.1-3.1a11.25 11.25 0 0 0-2.63 4.31c-.12.362-.12.752 0 1.114 1.489 4.467 5.704 7.69 10.675 7.69 1.5 0 2.933-.294 4.242-.827l-2.477-2.477A5.25 5.25 0 0 1 6.75 12Z" />
                                    </svg>

                                    <!-- olho aberto -->
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" id="eye-open1" class="icone-senha" style="display: none;">
                                        <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
                                        <path fill-rule="evenodd" d="M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 0 1 0-1.113ZM17.25 12a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Z" clip-rule="evenodd" />
                                    </svg>
                                </button>
                            </div>
                            <small class="erro" id="erroSenha"></small>
                        </div>

                        <!--Campos: Repetir senha-->
                        <div class="form-group">
                            <label for="repetirSenha">Repita a senha:<span>*</span></label>
                            <div class="repetirSenha-container">
                                <input type="password" id="repetirSenha">
                                <button type="button" class="toggle-password" id="togglePassword2" aria-label="Mostrar senha" aria-pressed="false" title="Mostrar senha">
                                    <!-- olho fechado -->
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" id="eye-closed2" class="icone-senha">
                                        <path d="M3.53 2.47a.75.75 0 0 0-1.06 1.06l18 18a.75.75 0 1 0 1.06-1.06l-18-18ZM22.676 12.553a11.249 11.249 0 0 1-2.631 4.31l-3.099-3.099a5.25 5.25 0 0 0-6.71-6.71L7.759 4.577a11.217 11.217 0 0 1 4.242-.827c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113Z" />
                                        <path d="M15.75 12c0 .18-.013.357-.037.53l-4.244-4.243A3.75 3.75 0 0 1 15.75 12ZM12.53 15.713l-4.243-4.244a3.75 3.75 0 0 0 4.244 4.243Z" />
                                        <path d="M6.75 12c0-.619.107-1.213.304-1.764l-3.1-3.1a11.25 11.25 0 0 0-2.63 4.31c-.12.362-.12.752 0 1.114 1.489 4.467 5.704 7.69 10.675 7.69 1.5 0 2.933-.294 4.242-.827l-2.477-2.477A5.25 5.25 0 0 1 6.75 12Z" />
                                    </svg>

                                    <!-- olho aberto -->
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" id="eye-open2" class="icone-senha" style="display: none;">
                                        <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
                                        <path fill-rule="evenodd" d="M1.323 11.447C2.811 6.976 7.028 3.75 12.001 3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 0-9.186-3.223-10.675-7.69a1.762 1.762 0 0 1 0-1.113ZM17.25 12a5.25 5.25 0 1 1-10.5 0 5.25 5.25 0 0 1 10.5 0Z" clip-rule="evenodd" />
                                    </svg>
                                </button>
                            </div>
                            <small class="erro" id="erroRepetirSenha"></small>
                        </div>

                        <hr style="width: 100%; border: 0; border-top: 1px solid #6A6E72; margin: 5px 0 10px 0;">

                        <div class="button">
                            <button type="submit" class="btn-cadastrar">CADASTRAR</button>
                        </div>
                    </form>
                </div>
          `;
        } else if (tela === "gerencChamados") {
          conteudo = `
                <div class="container-Chamados">
                    <h2>CHAMADOS</h2>

                    <hr style="width: 100%; border: 0; border-top: 1px solid #6A6E72; margin: 10px 0 20px 0;">
                    
                    <table>
                    <thead>
                        <tr>
                        <th>Protocolo</th>
                        <th>Categoria</th>
                        <th>Data</th>
                        <th>Status</th>
                        <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="tabela-chamados"></tbody>
                    </table>
                </div>
                `;
                setTimeout(() => carregarChamados(), 50);
        } else if (tela === "meusDadosAdmin") {
          conteudo = `
              <div class="container-meusDados">
                  <h2>MEUS DADOS</h2>
                  <div class="user-profile">
                    <svg class="profile-icon" xmlns="http://www.w3.org/2000/svg" fill="none"
                      viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round"
                        d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z" />
                    </svg>
                  </div>

                  <hr style="width: 100%; border: 0; border-top: 1px solid #6A6E72; margin: 10px 0 20px 0;">

                  <div class="user-info">
                    <div class="info"><label>Nome:</label><input id="nome" readonly></div>
                    <div class="info"><label>ID:</label><input id="idTecnico" readonly></div>
                    <div class="info"><label>CPF:</label><input id="cpf" readonly></div>
                    <div class="info"><label>Telefone:</label><input id="telefone" readonly></div>
                    <div class="info"><label>E-mail:</label><input id="email" readonly></div>
                    <div class="info"><label>Senha:</label><input id="senha" type="password" readonly></div>
                  </div>

                  <div class="button">
                    <button id="editar-btn" class="btn-principal">EDITAR DADOS</button>
                    <button id="salvar-btn" style="display:none;">SALVAR DADOS</button>
                  </div>
                </div>
          `;
          setTimeout(() => carregarMeusDados(), 50);
          setTimeout(() => {
              document.getElementById("editar-btn").addEventListener("click", habilitarEdicao);
              document.getElementById("salvar-btn").addEventListener("click", salvarDadosAdmin);
          }, 100);

        }

        area.innerHTML = conteudo;

        // Adiciona os eventos depois que o HTML foi injetado
        if (tela === "gerencFuncionarios") {
          const btnCadTec = document.getElementById("btnCadTec");
          if (btnCadTec) {
            btnCadTec.addEventListener("click", () => {
              mostrarTela("subtelaCadTec");
            });
          }
        }

        if (tela === "subtelaUrgentes") {
          const btnCadAdmin = document.getElementById("btnCadAdmin");
          if (btnCadAdmin) {
            btnCadAdmin.addEventListener("click", () => {
              mostrarTela("subtelaCadAdmin");
            });
          }
        }

        if (tela === "subtelaCadTec") {
          const avancarCadastro = document.getElementById("btnAvancar");
          if (avancarCadastro) {
            avancarCadastro.addEventListener("click", () => {
              mostrarTela("subtelaCadTec2");
            });
          }
        }

        if (tela === "subtelaCadAdmin") {
          const avancarCadastro = document.getElementById("btnAvancar");
          if (avancarCadastro) {
            avancarCadastro.addEventListener("click", () => {
              mostrarTela("subtelaCadAdmin2");
            });
          }
        }

        // barra de pesquisa para funcionários
        if (tela === "gerencFuncionarios") {
          const inputPesquisa = document.getElementById("pesquisa");
          const tabela = document.getElementById("tabela-funcionarios");
          const linhas = tabela.getElementsByTagName("tr");

          inputPesquisa.addEventListener("keyup", function () {
            const termo = inputPesquisa.value.toLowerCase();
            for (let i = 0; i < linhas.length; i++) {
              const colunas = linhas[i].getElementsByTagName("td");
              if (colunas.length > 0) {
                const nome = colunas[1].textContent.toLowerCase();
                const email = colunas[2].textContent.toLowerCase();
                linhas[i].style.display =
                  nome.includes(termo) || email.includes(termo) ? "" : "none";
              }
            }
          });

          // redirecionamento para as telas e cadastro
          const toggleBtn = document.getElementById("toggle-btn");
          const opcoes = document.querySelector(".opcoes");
          toggleBtn.addEventListener("click", () => {
            toggleBtn.classList.toggle("ativo");
            opcoes.classList.toggle("mostrar");
          });

          document
            .getElementById("btnCadTec")
            .addEventListener("click", () => mostrarTela("subtelaCadTec"));
          document
            .getElementById("btnCadAdmin")
            .addEventListener("click", () => mostrarTela("subtelaCadAdmin"));
        }
        
      }

      /**
       * ! serve apenas para travar a tela que estou mexendo!!
       **/
      document.addEventListener("DOMContentLoaded", () => {
        mostrarTela("meusDadosAdmin");
      });
      
    </script>


    <!-- FUNÇÕES PARA CONSUMIR API -->
    <script>
      // LISTA OS FUNCIONÁRIOS
      async function carregarFuncionarios() {
      const tabela = document.getElementById("tabela-funcionarios");
      tabela.innerHTML = "<tr><td colspan='4'>Carregando...</td></tr>";

      try {
          const response = await fetch("http://localhost:5030/api/usuarios");
          const usuarios = await response.json();

          // filtrar apenas tecnico e administrador
          const filtrados = usuarios.filter(u =>
              u.tipo === "tecnico" || u.tipo === "administrador"
          );

          tabela.innerHTML = "";

          filtrados.forEach(user => {
              const tr = document.createElement("tr");
              tr.innerHTML = `
                  <td>${user.tipo}</td>
                  <td>${user.nome}</td>
                  <td>${user.email}</td>
                  <td class="td-acao">
                      <button class="btn-acao" onclick="verDadosFuncionario('${user.id}')">Dados</button>
                      <button class="btn-acao" onclick="excluirFuncionario('${user.id}')">Excluir</button>
                  </td>
              `;
              tabela.appendChild(tr);
          });

          if (filtrados.length === 0) {
              tabela.innerHTML = "<tr><td colspan='4'>Nenhum funcionário encontrado.</td></tr>";
          }

      } catch (error) {
          console.error(error);
          tabela.innerHTML = "<tr><td colspan='4'>Erro ao carregar funcionários.</td></tr>";
      }
    }

    // LISTA OS CHAMADOS
    async function carregarChamados() {
    const tabela = document.getElementById("tabela-chamados");
    tabela.innerHTML = "<tr><td colspan='5'>Carregando...</td></tr>";

    try {
        const response = await fetch("http://localhost:5030/api/chamados");
        const chamados = await response.json();

        tabela.innerHTML = "";

        chamados.forEach(c => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
                <td>${c.protocolo}</td>
                <td>${c.categoria}</td>
                <td>${c.dataAbertura}</td>
                <td>${c.status}</td>
                <td><button class="btn-acao" onclick="visualizarChamado('${c.protocolo}')">Visualizar</button></td>
            `;
            tabela.appendChild(tr);
        });

    } catch {
        tabela.innerHTML = "<tr><td colspan='5'>Erro ao carregar chamados.</td></tr>";
    }
  }

    // PUXA OAS INFORMAÇÕES DO CHAMADO EPLO PROTOCOLO
    async function visualizarChamado(protocolo) {
      const response = await fetch(`/api/chamados/${protocolo}`);
      const chamado = await response.json();

      alert(`
        Protocolo: ${chamado.protocolo}
        Cliente: ${chamado.cliente}
        Descrição: ${chamado.descricao}
        Status: ${chamado.status}
      `);
    }

    // CARREGA DADOS DO ADMINISTRADOR
    async function carregarMeusDados() {

    const id = sessionStorage.getItem("usuarioId");

    if (!id) {
        console.warn("Nenhum usuário logado encontrado no sessionStorage.");
        return;
    }

    try {
        const response = await fetch(`http://localhost:5030/api/usuarios/${id}`);
        const user = await response.json();

        document.getElementById("nome").value = user.nome;
        document.getElementById("idTecnico").value = user.id;
        document.getElementById("cpf").value = user.cpf;
        document.getElementById("telefone").value = user.telefone;
        document.getElementById("email").value = user.email;
        document.getElementById("senha").value = user.senha;

        // senha normalmente não vem — coloque se sua API retornar
        if (user.senha) {
            document.getElementById("senha").value = user.senha;
        }

    } catch (error) {
        console.error("Erro ao carregar meus dados:", error);
    }
  }

    // HABILITAR E DESABILITAR EDIÇÃO EM MEUS DADOS
    function habilitarEdicao() {
    document.getElementById("nome").removeAttribute("readonly");
    document.getElementById("cpf").removeAttribute("readonly");
    document.getElementById("telefone").removeAttribute("readonly");
    document.getElementById("email").removeAttribute("readonly");
    document.getElementById("senha").removeAttribute("readonly");

    // mostra o botão SALVAR
    document.getElementById("salvar-btn").style.display = "block";

    // esconde o EDITAR
    document.getElementById("editar-btn").style.display = "none";
}

    function desabilitarEdicao() {
        document.getElementById("nome").setAttribute("readonly", true);
        document.getElementById("cpf").setAttribute("readonly", true);
        document.getElementById("telefone").setAttribute("readonly", true);
        document.getElementById("email").setAttribute("readonly", true);
        document.getElementById("senha").setAttribute("readonly", true);

        document.getElementById("salvar-btn").style.display = "none";
        document.getElementById("editar-btn").style.display = "block";
    }

    // SALVAR NOVOS DADOS NO BANCO
    async function salvarDadosAdmin() {
    const id = sessionStorage.getItem("usuarioId");

    const dadosAtualizados = {
        nome: document.getElementById("nome").value,
        cpf: document.getElementById("cpf").value,
        telefone: document.getElementById("telefone").value,
        email: document.getElementById("email").value,
        senha: document.getElementById("senha").value,
    };

    try {
        const response = await fetch(`http://localhost:5030/api/usuarios/${id}`, {
            method: "PUT",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(dadosAtualizados)
        });

        if (!response.ok) {
            alert("Erro ao salvar dados.");
            return;
        }

        alert("Dados atualizados com sucesso!");

        // Recarrega os dados da API
        carregarMeusDados();

        // Desabilita edição novamente
        desabilitarEdicao();

    } catch (error) {
        console.error("Erro ao salvar dados:", error);
        alert("Erro ao salvar dados. Verifique o console.");
    }
}

    // VALIDAÇÃO DA PRIMEIRA ETAPA DO CADTEC
    function validarPrimeiraEtapa() {
    let valido = true;

    const nome = document.getElementById("nome").value.trim();
    const cpf = document.getElementById("cpf").value.trim();
    const telefone = document.getElementById("telefone").value.trim();
    const area = document.getElementById("areaEspecializacao").value;
    const nivel = document.getElementById("nivelExperiencia").value;

    // Resetar erros
    document.getElementById("erroNome").innerText = "";
    document.getElementById("erroCpf").innerText = "";
    document.getElementById("erroTelefone").innerText = "";
    document.getElementById("erroArea").innerText = "";
    document.getElementById("erroNivel").innerText = "";

    if (!nome) {
        document.getElementById("erroNome").innerText = "Informe o nome.";
        valido = false;
    }

    const cpfRegex = /^\d{11}$/; // somente números
    if (!cpfRegex.test(cpf)) {
        document.getElementById("erroCpf").innerText = "CPF inválido. Use 11 números.";
        valido = false;
    }

    const telRegex = /^\d{10,11}$/; // telefone fixo ou celular
    if (!telRegex.test(telefone)) {
        document.getElementById("erroTelefone").innerText = "Telefone inválido.";
        valido = false;
    }

    if (!area) {
        document.getElementById("erroArea").innerText = "Selecione a área de especialização.";
        valido = false;
    }

    if (!nivel) {
        document.getElementById("erroNivel").innerText = "Selecione o nível de experiência.";
        valido = false;
    }

    return valido;
}

// Listener do botão Avançar
document.addEventListener("click", function(e){
    if(e.target && e.target.id === "btnAvancar"){
        e.preventDefault();
        if(validarPrimeiraEtapa()){
            sessionStorage.setItem("cadastroTec", JSON.stringify({
                nome: document.getElementById("nome").value.trim(),
                cpf: document.getElementById("cpf").value.trim(),
                telefone: document.getElementById("telefone").value.trim(),
                area: document.getElementById("areaEspecializacao").value,
                nivel: document.getElementById("nivelExperiencia").value
            }));
            mostrarTela("subtelaCadTec2");
        }
    }
});

function validarSegundaEtapa() {
    let valido = true;

    const email = document.getElementById("email").value.trim();
    const senha = document.getElementById("senha").value;
    const repetirSenha = document.getElementById("repetirSenha").value;

    // Resetar erros
    document.getElementById("erroEmail").innerText = "";
    document.getElementById("erroSenha").innerText = "";
    document.getElementById("erroRepetirSenha").innerText = "";

    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
        document.getElementById("erroEmail").innerText = "Email inválido.";
        valido = false;
    }

    if (senha.length < 6) {
        document.getElementById("erroSenha").innerText = "Senha deve ter pelo menos 6 caracteres.";
        valido = false;
    }

    if (senha !== repetirSenha) {
        document.getElementById("erroRepetirSenha").innerText = "As senhas não coincidem.";
        valido = false;
    }

    return valido;
}

document.addEventListener("click", function(e){
    if(e.target && e.target.classList.contains("btn-cadastrar")){
        e.preventDefault();

        if(!validarSegundaEtapa()) return;

        const dadosEtapa1 = JSON.parse(sessionStorage.getItem("cadastroTec") || "{}");

        const dadosCadastro = {
            ...dadosEtapa1,
            email: document.getElementById("email").value.trim(),
            senha: document.getElementById("senha").value,
            tipo: "tecnico"
        };

        fetch("http://localhost:5030/api/usuarios", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(dadosCadastro)
        })
        .then(async response => {
            if(!response.ok){
                const erro = await response.text();
                alert("Erro ao cadastrar técnico: " + erro);
                return;
            }
            alert("Técnico cadastrado com sucesso!");
            sessionStorage.removeItem("cadastroTec");
            mostrarTela("gerencFuncionarios");
        })
        .catch(error => {
            console.error("Erro ao cadastrar técnico:", error);
            alert("Erro ao cadastrar técnico. Veja o console.");
        });
    }
});

    </script>
  </body>
</html>
